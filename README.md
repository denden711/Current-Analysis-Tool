# Current-Analysis-Tool

## プロジェクトの説明
Current-Analysis-Toolは、CSVファイルに含まれる電流データを解析し、特定の計算やデータフォーマット変換を行うためのツールです。このツールは、放電プラズマの研究におけるデータ処理を簡便化し、効率的に行うことを目的としています。

## コードの主な機能と仕様
1. **CSVファイルの選択と読み込み**：
    - 指定したフォルダ内のすべてのCSVファイルを自動的に処理します。

2. **データと数式の挿入**：
    - 電圧と電流の最大値・最小値の計算。
    - 特定のフェーズ角度や周波数の計算。
    - 指定された列に対する複雑な数式の自動入力。

3. **ファイルの保存**：
    - 処理されたデータを含むExcelファイル（.xlsx）として保存。
    - 再変換されたCSVファイルを同じフォルダに保存。

## インストール方法
1. VBAエディタを開きます（ExcelでAlt + F11を押します）。
2. 新しいモジュールを挿入します（挿入 -> モジュール）。
3. 提供されたコードをそれぞれのモジュールにコピー＆ペーストします。

## 使用方法
1. Excelでマクロを有効にします。
2. VBAエディタで「貼り付け変換(1次)」または「貼り付け変換(2次)」のサブルーチンを実行します。
3. フォルダ選択ダイアログで、CSVファイルが格納されているフォルダを選択します。
4. プログラムが自動的にCSVファイルを処理し、結果を保存します。

### 貼り付け変換(1次).bas
このモジュールは、CSVファイルを開き、データを読み込んでから特定の計算を実行し、新しいExcelファイルとして保存します。さらに、再変換されたCSVファイルも保存されます。

#### 主な機能
- 電圧と電流の最大値・最小値の計算。
- フェーズ角度や周波数の計算。
- 列への数式の自動入力。
- 処理ログの作成。

### 貼り付け変換(2次).bas
このモジュールも同様に、CSVファイルを処理してExcelファイルとして保存しますが、追加のデータラベルと数式を挿入し、複雑な計算を実行します。

#### 主な機能
- 追加のデータラベルの挿入。
- より詳細な数式の自動入力。
- 列の書式設定のカスタマイズ。
